#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>
#define BUFFER_SIZE 256

int main(int argc, char *argv[]) {
  if (argc < 3) {
    fprintf(stderr, "недостаточно аргументов\n");
    return 1;
  }
  char c;
  char *substring = argv[1];
  char *filename = argv[2];
  int sub_len = strlen(substring);

  FILE *file = fopen(filename, "r");
  if (!file) {
    perror("grep");
    return 1;
  }
  int a = 1;
while(a){
  int len = 0;
  size_t buffer_size = BUFFER_SIZE;
  char *buffer = malloc(buffer_size);
  while ((c = getchar()) != EOF && c != '\n') {
    if (len + 1>= buffer_size) {
	    buffer_size *= 2;
	    char *new_buffer = realloc(buffer, buffer_size);
	    if (!new_buffer) {
		free(buffer);
		return 1;
	    }
	    buffer = new_buffer;
	}
  }
    buffer[len] = '\0';
    int f = 0;
    for (int start = 0; start <= len - sub_len; start++) {
      int m = 1;
      for (int i = 0; i < sub_len; i++) {
        char c1 = substring[i];
        char c2 = buffer[start + i];
        if (tolower(c1) != tolower(c2)) {
          m = 0;
          break;
	}
      }
      
      if (m) {
        f = 1;
        break;
      }
    }
    
    if (f) {
        printf("%s\n", buffer);
      }
    }

    fclose(file);
    return 0;
}
